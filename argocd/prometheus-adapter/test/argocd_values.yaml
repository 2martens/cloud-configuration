prometheus-adapter:
  prometheus:
    url: http://prometheus.observability.svc

  rules:
    resource:
      cpu:
        containerQuery: |
          sum by (<<.GroupBy>>) (
            irate (
                container_cpu_usage_seconds_total{<<.LabelMatchers>>,container!="",pod!=""}[4m]
            )
          )
        nodeQuery: |
          sum by (<<.GroupBy>>) (
            irate(
                node_cpu_usage_seconds_total{<<.LabelMatchers>>}[4m]
            )
          )
        resources:
          overrides:
            node:
              resource: node
            namespace:
              resource: namespace
            pod:
              resource: pod
        containerLabel: container
      memory:
        containerQuery: |
          sum by (<<.GroupBy>>) (
            container_memory_working_set_bytes{<<.LabelMatchers>>,container!="",pod!=""}
          )
        nodeQuery: |
          sum by (<<.GroupBy>>) (
            node_memory_working_set_bytes{<<.LabelMatchers>>}
          )
        resources:
          overrides:
            node:
              resource: node
            namespace:
              resource: namespace
            pod:
              resource: pod
        containerLabel: container
      window: 5m